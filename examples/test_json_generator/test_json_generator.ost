[] $tests

[ 
	readln $src
	Nil $top
	[
		clear
		[ 
			# parse code
			src parse $ast
			# check for parsing errors
			ast type "Nil" == [
				"Parsing error" throw
			] ifstr parse! 
			# now we have ast on the stack. Execute it
			ast!
			"hey" print_str
			# get top element
			=top
		] 0 try not
	] [] while
	src writeln
	top serialize writeln
] $generate_test

generate_test!